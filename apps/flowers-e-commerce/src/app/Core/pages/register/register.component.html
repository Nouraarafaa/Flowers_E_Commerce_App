<section class="flex justify-center min-h-screen">

    <div class="flex justify-center items-center flex-col gap-10 my-10">
        
        <div class="language w-full flex justify-end">
            <h2 class="text-black text-[16px] font-zain">العربيه</h2>
        </div>

        <div class="decor">
            <app-decor-top></app-decor-top>
        </div>

        <div>
            <p class="text-3xl text-maroon-700  font-Edwardian">Become part of our family!</p>
        </div>
        <div class="form w-[410px] h-auto border-y border-[#E4E4E7] py-8">
            <form [formGroup]="registerForm" (ngSubmit)="submitForm()" class="flex flex-col gap-8">
                <div class="userName flex gap-5">
                    <div class="firstName"> 
                        @let firstNameControl = registerForm.get("firstName");
                        <label for="firstName" class="text-black text-[14px] font-inter font-medium">First Name</label>
                        <app-form-input formControlName="firstName" [id]="'firstName'" [type]="'text'" [nameControl]="firstNameControl" [placeholder]="'First Name...'" ></app-form-input>
                        <app-error-message [nameControl]="firstNameControl"></app-error-message>
                    </div> 
                    <div class="lastName"> 
                        @let lastNameControl = registerForm.get("lastName");
                        <label for="lastName" class="text-black text-[14px] font-inter font-medium">Last Name</label>
                        <app-form-input formControlName="lastName" [id]="'lastName'" [type]="'text'" [nameControl]="lastNameControl" [placeholder]="'Last Name...'" ></app-form-input>
                        <app-error-message [nameControl]="lastNameControl"></app-error-message>
                    </div> 
                </div>
                <div class="email"> 
                    @let emailControl = registerForm.get("email");
                    <label for="email" class="text-black text-[14px] font-inter font-medium">Email</label>
                    <app-form-input formControlName="email" [id]="'email'" [type]="'email'" [nameControl]="emailControl" [placeholder]="'Email...'"></app-form-input>
                    <app-error-message [nameControl]="emailControl"></app-error-message>
                </div>
                <div class="phone"> 
                    @let phoneControl = registerForm.get("phone");
                    <label for="phone" class="text-black text-[14px] font-inter font-medium">Phone</label>
                    <app-form-input formControlName="phone" [id]="'phone'" [type]="'tel'" [nameControl]="phoneControl" [placeholder]="'Phone...'" ></app-form-input>                
                    <app-error-message [nameControl]="phoneControl"></app-error-message>
                </div>
                <div class="gender"> 
                    @let genderControl = registerForm.get("gender");
                    <label for="gender" class="text-black text-[14px] font-inter font-medium">gender</label>
                    <div class="flex flex-col gap-2">
                        <div class="relative">
                            <select id="gender" required formControlName="gender" class="appearance-none w-full h-[49px] px-4 py-[12px] rounded-[10px] border border-[#D4D4D8] bg-white text-[#111] placeholder:text-[#A1A1AA] text-sm outline-none transition-all duration-200 focus:border-[#7A1D1D] focus:ring-2 focus:ring-[#7A1D1D]/20 cursor-pointer invalid:text-[#A1A1AA]"
                            [ngClass]="{
                                'border-[#7A1D1D]': !genderControl?.invalid || !genderControl?.touched,
                                'border-[#F04438]': genderControl?.invalid && genderControl?.touched
                            }"
                            >
                                <option value="" disabled selected hidden>Select your gender</option>
                                <option value="male" class="bg-white hover:bg-gray-100 text-[#111] py-2">Male</option>
                                <option value="female" class="bg-white hover:bg-gray-100 text-[#111] py-2">Female</option>
                            </select>
                            <svg
                            class="pointer-events-none absolute right-4 top-1/2 -translate-y-1/2 w-4 h-4 text-[#7A1D1D]"
                            xmlns="http://www.w3.org/2000/svg"
                            fill="none"
                            viewBox="0 0 24 24"
                            stroke="currentColor"
                            stroke-width="2"
                            >
                            <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
                            </svg>
                        </div>
                    </div>
                    <app-error-message [nameControl]="genderControl"></app-error-message>
                </div>
                <div class="password relative"> 
                    @let passwordControl = registerForm.get("password");
                    <label for="password" class="text-black text-[14px] font-inter font-medium">Password</label>
                    <app-form-input formControlName="password" [id]="'password'" [type]="togglePassword() ? 'text' : 'password'" [nameControl]="passwordControl" [placeholder]="'Password...'" ></app-form-input>                
                    @if (togglePassword()) {
                        <span (click)="togglePasswordVisibility()" class="absolute cursor-pointer top-[38px] right-2"> <i class="fa-solid fa-eye"></i> </span>
                    }@else {    
                        <span (click)="togglePasswordVisibility()" class="absolute cursor-pointer top-[38px] right-2"> <i class="fa-solid fa-eye-slash"></i> </span>
                    }
                    <app-error-message [nameControl]="passwordControl"></app-error-message>
                </div> 
                <div class="rePassword relative"> 
                    @let rePasswordControl = registerForm.get("rePassword");
                    <label for="rePassword" class="text-black text-[14px] font-inter font-medium">Confirm Password</label>
                    <app-form-input formControlName="rePassword" [id]="'rePassword'" [type]="togglePassword() ? 'text' : 'password'" [nameControl]="rePasswordControl" [placeholder]="'rePassword...'" ></app-form-input>                
                    @if (togglePassword()) {
                        <span (click)="togglePasswordVisibility()" class="absolute cursor-pointer top-[38px] right-2"> <i class="fa-solid fa-eye"></i> </span>
                    }@else {    
                        <span (click)="togglePasswordVisibility()" class="absolute cursor-pointer top-[38px] right-2"> <i class="fa-solid fa-eye-slash"></i> </span>
                    }
                    @if ( (rePasswordControl?.errors || registerForm.getError("misMatch")) && rePasswordControl?.touched ) {
                        <div class="flex items-start gap-2 mt-1 mb-3 p-2 rounded-xl border border-red-200 bg-red-50 text-red-700 shadow-sm transition-all duration-300" role="alert">
                            <svg
                                class="w-5 h-5 mt-[2px] flex-shrink-0 text-red-500"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="2"
                                viewBox="0 0 24 24"
                                >
                                <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                d="M12 9v2m0 4h.01M4.93 4.93l14.14 14.14M12 2a10 10 0 100 20 10 10 0 000-20z"
                                />
                            </svg>
                            <ul class="space-y-1 text-sm font-inter font-medium list-disc list-inside">
                                @if (rePasswordControl?.getError("required")) {
                                    <li>Required</li>
                                }
                                @else if (registerForm.getError("misMatch")) {
                                    <li>Password and rePassword should match</li>
                                }
                            </ul>
                        </div>
                    }
                </div>
                <p-button [loading]="isCallingAPI()" [disabled]="isCallingAPI()" type="submit" label="Create Account" aria-labelledby="auth-continue" styleClass="w-full !bg-maroon-600 hover:!bg-maroon-700 !transition-colors !duration-300 !shadow-[0px_18px_30px_0px_#2F1C1C1A] h-[41px] !px-4 py-3.5 !gap-2 !rounded-[10px] text-[#FFFFFF] text-[16px] !font-normal !border-none !outline-none" />
                
                @if (success()) {
                    <div class="p-2 text-sm text-green-800 rounded-lg bg-green-50 dark:bg-gray-800 dark:text-green-400" role="alert">
                        <span class="font-inter font-medium"> {{success()}} </span>
                    </div>
                }
                @else if (errorMsg()) { 
                    <div class="p-2 text-sm text-red-800 rounded-lg bg-red-50 dark:bg-gray-800 dark:text-red-400" role="alert">
                    <span class="font-inter font-medium"> {{errorMsg()}} </span>
                    </div>
                }
            </form>
        </div>
        
        <div class="logIn flex justify-center text-[16px] font-inter font-medium">
            <p class="text-[#313131]">Already have an account?</p> <a routerLink="/login" class="text-maroon-700 hover:text-maroon-500 transition-colors duration-300 pl-1">Login</a>
        </div>

        <div class="decor">
            <app-decor-bottom></app-decor-bottom>
        </div>

    </div>

</section>
